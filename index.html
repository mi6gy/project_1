<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />

  <!-- links -->
  <!-- <link rel="icon" type="image/png" href="assets/img/favicon.png" /> -->
  <!-- <link href="#google fonts" rel="stylesheet"> -->
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
    integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous" />
  <link href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="assets/css/style.css" />

  <title>Read Your Movie</title>
</head>

<body>

  <div class="container center-align">

    <!-- Titled Navbar -->
    <nav class="nav-extended">
      <div class="nav-wrapper">
        <a href="https://mi6gy.github.io/project_1/" class="center">
          <h3>Read Your Movie</h3>
        </a>
      </div>
      <div class="nav-content">
      </div>
    </nav>

    <div class="container">
      <form id="contentForm" action='search' method='get'>
        <div class="input-group">
          <div class="input-field">
            <input id="contentInput" type="search" name='q'>
            <label class="label-icon" for="contentInput">
              <i class="material-icons">search for a movie</i>
            </label>
          </div>
          <button id="findContent" type="submit" value="Movie Search" class="input-group-addon btn">search</button>
        </div>

      </form>
    </div>

    <!-- Search field -->
    <!-- <form id="contentForm">
      <label for="contentInput">Search for a movie</label>
      <input type="text" id="contentInput"><br>

      <input id="findContent" type="submit" value="Movie Search">
    </form> -->





    <body>

      <br>
      <br>

      <!-- Row for Searching -->
      <div class="row center-align">

        <!-- Movie card -->
        <div class="col s12 m6 l6">
          <div class="card center-align">
            <div class="card-image card-movies">
              <span class="card-title"></span>
              <h4 id="movie-title"></h4>
            </div>
            <div class="card-content">
              <img class="responsive-img" id="movie-image" src="">
              <div class="movieRating">
                <p id="movie-rating"></p>
              </div>
              <div class="moviePlot">
                <p id="movie-plot"></p>
              </div>
            </div>
            <div class="card-action">
              <a id="movie-link" href="">Watch this Movie!</a>
            </div>
          </div>
        </div>

        <!-- Book card -->
        <div class="col s12 m6 l6">
          <div class="card center-align">
            <div class="card-image">
              <span class="card-title"></span>
              <h4 id="book-title"></h4>
            </div>
            <div class="card-content">
              <img class="responsive-img" id="book-image" src="">
              <div class="googleRating">
                <p id="book-rating"></p>
              </div>
              <div class="googlePlot">
                <p id="book-plot"></p>
              </div>
            </div>
            <div class="card-action">
              <a id="book-link" href="">Read this Book!</a>
            </div>
          </div>
        </div>
      </div>
  </div>

  <!-- footer -->
  <footer class="page-footer container">
    <div class="container">
      <div class="row">
        <div class="col s12 m12 l12 center">
          <img id="coffeelogo" src="assets/images/readyourmovie2.png">
          <p class="grey-text text-lighten-4">Created by Anthony, Hojin, Lane, Miguel</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- scripts -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script type="text/javascript">

    // search click function
    $("#findContent").on("click", function (event) {
      event.preventDefault()
      var book = $("#contentInput").val();
      var queryBooksURL = "https://www.googleapis.com/books/v1/volumes?q=" + book + "&key=AIzaSyBfde9KgHwbNNBEW_J011ZGwrHD0G0O1go"

      // get books
      $.ajax({
        url: queryBooksURL,
        method: "GET"
      }).then(function (googleResponse) {
        console.log(googleResponse);
        var queryMoviesURL = "https://www.omdbapi.com/?t=" + book + "&apikey=101156dc";

        // get movies
        $.ajax({
          url: queryMoviesURL,
          method: "GET"
        }).then(function (movieResponse) {
          console.log(movieResponse);

          // append content
          if (googleResponse.items.length > 0 && movieResponse.Response != "False") {
            $("#movie-title").text(movieResponse.Title);
            $("#movie-plot").text(movieResponse.Plot);
            $("#movie-image").attr("src", movieResponse.Poster);
            $("#movie-rating").text("Rating: " + movieResponse.Ratings[0].Value);
            $("#movie-link").attr("href", "https://play.google.com/store/search?q=" + movieResponse.Title + "&c=movies")
            $("#book-title").text(googleResponse.items[0].volumeInfo.title);
            $("#book-image").attr("src", googleResponse.items[0].volumeInfo.imageLinks.thumbnail);
            $("#book-rating").text("Rating: " + googleResponse.items[0].volumeInfo.averageRating + "/5")
            $("#book-plot").text(googleResponse.items[0].volumeInfo.description);
            $("#book-link").attr("href", "https://play.google.com/store/search?q=" + googleResponse.items[0].volumeInfo.title + "&c=books")

          }
          // if no results
          else {
            $("#bookView").html("<p>Movie not found</p>");
          }
        });
      }).catch(function (err) {
        console.log(err);
      })
    });

  </script>

</body>

</html>
